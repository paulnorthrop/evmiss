<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>GEV influence curves — gev_influence • evmiss</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="GEV influence curves — gev_influence"><meta name="description" content="Calculates influence function curves for maximum likelihood estimators of
Generalised Extreme Value (GEV) parameters."><meta property="og:description" content="Calculates influence function curves for maximum likelihood estimators of
Generalised Extreme Value (GEV) parameters."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">evmiss</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="nav-link" href="https://github.com/paulnorthrop/evmiss/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>GEV influence curves</h1>
      <small class="dont-index">Source: <a href="https://github.com/paulnorthrop/evmiss/blob/HEAD/R/gev_influence.R"><code>R/gev_influence.R</code></a></small>
      <div class="d-none name"><code>gev_influence.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculates influence function curves for maximum likelihood estimators of
Generalised Extreme Value (GEV) parameters.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">gev_influence</span><span class="op">(</span><span class="va">z</span>, mu <span class="op">=</span> <span class="fl">0</span>, sigma <span class="op">=</span> <span class="fl">1</span>, xi <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'gev_influence'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, xvar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"z"</span>, <span class="st">"y"</span><span class="op">)</span>, sep_xi <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">vlines</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-z">z<a class="anchor" aria-label="anchor" href="#arg-z"></a></dt>
<dd><p>A numeric vector. Values of normal quantiles \(z\) at which to
calculate the GEV influence function. See <strong>Details</strong>.</p></dd>


<dt id="arg-mu-sigma-xi">mu, sigma, xi<a class="anchor" aria-label="anchor" href="#arg-mu-sigma-xi"></a></dt>
<dd><p>Numeric scalars supplying the values of the GEV
parameters \(\mu\), \(\sigma\) and \(\xi\). These vectors are
recycled to the length of the longest vector.</p></dd>


<dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>An object inheriting from class <code>"gev_influence"</code>, a result of a
call to <code>gev_influence</code>.</p></dd>


<dt id="arg-xvar">xvar<a class="anchor" aria-label="anchor" href="#arg-xvar"></a></dt>
<dd><p>A logical scalar.
If <code>xvar = "z"</code> then the influence curves are plotted against the standard
normal quantiles in <code>x[, "z"]</code>.
If <code>xvar = "y"</code> then the influence curves are plotted against the
corresponding GEV quantiles in <code>x[, "y"]</code>.</p></dd>


<dt id="arg-sep-xi">sep_xi<a class="anchor" aria-label="anchor" href="#arg-sep-xi"></a></dt>
<dd><p>A logical scalar. If <code>sep_xi = TRUE</code> then separate vertical
scales are used for \(\xi\) and \((\mu, \sigma)\). The scale for
\(\xi\) appears on the left and the scale for \((\mu, \sigma)\) on the
right.</p></dd>


<dt id="arg-vlines">vlines<a class="anchor" aria-label="anchor" href="#arg-vlines"></a></dt>
<dd><p>A numeric vector. If <code>vlines</code> is supplied then black dashed
vertical lines are added to the plot at the values in <code>vlines</code> on the
horizontal axis. This might be used to indicate the values of certain
observations in a dataset.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>For <code>plot.gev_influence</code>: to pass graphical parameters to the
graphical functions <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">matplot</a></code> and
<code><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></code>. The parameters <code>col, lty</code> and <code>lwd</code> can be
used to control line colour, type and width, with the parameters in the
usual order, that is, \((\mu, \sigma, \xi)\).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>gev_influence</code>: an object with class
<code>c("gev_influence", "matrix", "array")</code>, a <code>length(z)</code> by <code>5</code> numeric
matrix. The first two columns contain the input values in <code>z</code> and the
corresponding values of <code>y</code>. Columns 3-5 contain the values of the GEV
influence function for \(\mu\), \(\sigma\) and \(\xi\) respectively
at the values of <code>z</code>.</p>
<p><code>plot.gev_influence</code>: nothing, only the plot is produced.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>An influence function measures the effect on a parameter estimator
of changing one observation in a sample. See Hampel (2005) and, in the
context of extreme value analyses of threshold exceedances,
Davison and Smith (1990).
Let \(\theta = (\mu, \sigma, \xi)\). The GEV influence curve is defined,
as a function of an observation \(y\), by
\(IC(y) = \{IC_{\mu}(y), IC_{\sigma}(y), IC_{\xi}(y)\} =
  i_\theta^{-1} {\rm d}\ell(y; \theta)/{\rm d} \theta\),
where \(\ell(y; \theta)\) is the GEV log-likelihood function and
\(i_\theta^{-1}\) is the GEV expected information matrix.
The value of \(y\) is related to \(z\) by
\(y = G^{-1}\{\Phi(z)\}\), where \(\Phi\) and \(G\) are the
distribution functions of a standard normal and
GEV(\(\mu, \sigma, \xi\)) distribution, respectively. Plotting influence
curves on the standard normal <code>z</code> scale can help to aid interpretation.</p>
<p>The value of \(IC(y)\) is invariant to the value of \(\mu\).
For a given value of \(\xi\), the values of \(IC_{\mu}(y)\) and
\(IC_{\sigma}(y)\) scale with the scale parameter \(\sigma\), that is,
doubling \(\sigma\) doubles \(IC_{\mu}(y)\) and \(IC_{\sigma}(y)\).
Typically, interest focuses on the shape parameter \(\xi\), but if the
input scale parameter \(\sigma\) is large then this may hide the
influence of \(y\) on \(\xi\). Therefore, the default setting of
<code>plot.gev_influence</code>, <code>sep_xi = TRUE</code>, separates the plotting of the
influence curve for \(\xi\) from those of \(\mu\) and \(\sigma\).</p>
<p>The example in <strong>Examples</strong> shows that extremely large block maxima have a
strong positive influence on the MLE \(\hat{\xi}\) and also that
extremely small block maxima have a strong negative influence on
\(\hat{\xi}\),</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Hampel, F. R., Ronchetti, E. M., Rousseeuw, P. J., and
Stahel, W. A. (2005). Robust Statistics. Wiley-Interscience, New York.
<a href="https://doi.org/10.1002/9781118186435" class="external-link">doi:10.1002/9781118186435</a></p>
<p>Davison, A. C. and Smith, R. L. (1990). Models for exceedances
over high thresholds. Journal of the Royal Statistical Society: Series B
(Methodological), 52(3):393–425. <a href="https://doi.org/10.1111/j.2517-6161.1990.tb01796.x" class="external-link">doi:10.1111/j.2517-6161.1990.tb01796.x</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Influence curve for the default mu = 0, sigma = 1, xi = 0 case</span></span></span>
<span class="r-in"><span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="op">-</span><span class="fl">3</span>, to <span class="op">=</span> <span class="fl">3</span>, by <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">inf</span> <span class="op">&lt;-</span> <span class="fu">gev_influence</span><span class="op">(</span>z <span class="op">=</span> <span class="va">z</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">inf</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="gev_influence-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Influence curves based on the adjusted fit to the Plymouth ozone data</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="gev_mle.html">gev_mle</a></span><span class="op">(</span><span class="va">PlymouthOzoneMaxima</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">infp</span> <span class="op">&lt;-</span> <span class="fu">gev_influence</span><span class="op">(</span>mu <span class="op">=</span> <span class="va">pars</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, sigma <span class="op">=</span> <span class="va">pars</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, xi <span class="op">=</span> <span class="va">pars</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, z <span class="op">=</span> <span class="va">z</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">infp</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="gev_influence-2.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Paul J. Northrop, Emma S. Simpson.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

