<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Methods for objects of class "evmiss_sim_study" — sim_study_methods • evmiss</title><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Methods for objects of class " evmiss_sim_study sim_study_methods><meta name="description" content='Methods for objects of class "evmiss_sim_study" returned from
sim_study.'><meta property="og:description" content='Methods for objects of class "evmiss_sim_study" returned from
sim_study.'></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">evmiss</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="nav-link" href="https://github.com/paulnorthrop/evmiss/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Methods for objects of class <code>"evmiss_sim_study"</code></h1>
      <small class="dont-index">Source: <a href="https://github.com/paulnorthrop/evmiss/blob/HEAD/R/methods_evmiss_sim_study.R"><code>R/methods_evmiss_sim_study.R</code></a></small>
      <div class="d-none name"><code>sim_study_methods.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Methods for objects of class <code>"evmiss_sim_study"</code> returned from
<code><a href="sim_study.html">sim_study</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'evmiss_sim_study'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  what <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"return"</span>, <span class="st">"mu"</span>, <span class="st">"sigma"</span>, <span class="st">"xi"</span>, <span class="st">"all"</span><span class="op">)</span>,</span>
<span>  distn <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"marginal"</span>, <span class="st">"joint"</span><span class="op">)</span>,</span>
<span>  approach <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"full"</span>, <span class="st">"adjust"</span>, <span class="st">"naive"</span>, <span class="st">"discard"</span><span class="op">)</span>,</span>
<span>  return_period <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  vertical <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"full"</span>, <span class="st">"adjust"</span>, <span class="st">"naive"</span>, <span class="st">"discard"</span><span class="op">)</span>,</span>
<span>  penultimate <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  line_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"orange"</span>, <span class="st">"purple"</span>, <span class="st">"red"</span>, <span class="st">"blue"</span><span class="op">)</span>,</span>
<span>  line_lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  legend <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">5</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  layout <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  no_ylab <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'evmiss_sim_study'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  what <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"all"</span>, <span class="st">"return"</span><span class="op">)</span>,</span>
<span>  <span class="va">return_period</span>,</span>
<span>  <span class="va">statistics</span>,</span>
<span>  meanSE <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  log <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  log_return <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  vsfull <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'summary.evmiss_sim_study'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, quiet <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">tab</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'evmiss_sim_study'</span></span>
<span><span class="fu">tab</span><span class="op">(</span><span class="va">object</span>, <span class="va">return_period</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x-object">x, object<a class="anchor" aria-label="anchor" href="#arg-x-object"></a></dt>
<dd><p>An object inheriting from class <code>"evmiss_sim_study"</code>, a
result of a call to the function <code><a href="sim_study.html">sim_study</a></code>. For
<code>plot.evmiss_sim_study</code>, further arguments to be passed to
<a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot.default</a> and <code><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></code>,
such as graphical parameters.</p></dd>


<dt id="arg-what">what<a class="anchor" aria-label="anchor" href="#arg-what"></a></dt>
<dd><p>A character scalar. What should be plotted? See <code>distn</code> for
further details. The default is <code>"return"</code> for the <code>plot</code> method and
<code>"all"</code> for the <code>summary</code> method.</p><ul><li><p><code>"return"</code>: estimates of return levels using the approaches <code>"full"</code>,
<code>"adjust"</code>, <code>"naive"</code> and <code>"discard"</code>.</p></li>
<li><p><code>"mu"</code> , <code>"sigma"</code>, <code>"xi"</code> or <code>"all"</code>. The name of the parameter whose
estimates are plotted. Use <code>"all"</code> to select all 3 GEV parameters.</p></li>
</ul></dd>


<dt id="arg-distn">distn<a class="anchor" aria-label="anchor" href="#arg-distn"></a></dt>
<dd><p>A character scalar. The default is <code>"marginal"</code>.</p><ul><li><p><code>"marginal"</code>: 4 histograms of point estimates.</p><ul><li><p>If <code>what = "return"</code> then 4 histograms of the point estimates of the
required return level are produced, one plot for each of the
approaches <code>"full"</code>, <code>"adjust"</code>, <code>"naive"</code> and <code>"discard"</code>.</p></li>
<li><p>If <code>what = "all"</code> then 3 histograms of the respective point
estimates of the GEV parameters \(\mu\), \(\sigma\) and \(\xi\)
are produced, for the approach supplied in <code>approach</code>.</p></li>
<li><p>if <code>what = "mu"</code>, <code>"sigma"</code> or <code>"xi"</code> then 4 histograms of the
point estimates of the chosen GEV parameter are produced, one for
each of the approaches <code>"full"</code>, <code>"adjust"</code>, <code>"naive"</code> and
<code>"discard"</code>.</p></li>
</ul></li>
<li><p><code>"joint"</code>:</p><ul><li><p>If <code>what = "return"</code> or <code>what = "mu"</code>, <code>"sigma"</code> or <code>"xi"</code> then
<code><a href="https://rdrr.io/r/graphics/pairs.html" class="external-link">pairs</a></code> is used to produce a matrix of scatter plots
to compare the estimates produced by the approaches.</p></li>
<li><p>If <code>what = "all"</code> then 3 scatter plots are produced, one for each
of the GEV parameters \(\mu\), \(\sigma\) and \(\xi\), to
compare the estimates from the 2 approaches supplied in <code>approach</code>.</p></li>
</ul></li>
</ul></dd>


<dt id="arg-approach">approach<a class="anchor" aria-label="anchor" href="#arg-approach"></a></dt>
<dd><p>A character scalar or vector. A proper subset of
<code>c("full", "adjust", "naive", "discard")</code>. Only relevant if <code>what</code> is
<code>"all"</code>. If <code>distn = "marginal"</code> then the default is <code>"full"</code>.
If <code>distn = "joint"</code> then the default is <code>c("full", "adjust")</code>.</p></dd>


<dt id="arg-return-period">return_period<a class="anchor" aria-label="anchor" href="#arg-return-period"></a></dt>
<dd><p>Either a numeric scalar (for <code>plot.evmiss_sim_study</code>)
or a numeric vector (for <code>summary.evmiss_sim_study</code> or
<code>tab.evmiss_sim_study</code>). A return period or periods, in numbers of blocks,
for which to compare the four estimation approaches. All values must be
greater than 1.</p></dd>


<dt id="arg-vertical">vertical<a class="anchor" aria-label="anchor" href="#arg-vertical"></a></dt>
<dd><p>logical scalar. Only relevant if <code>distn = "marginal"</code> or if
<code>distn = "joint"</code> and <code>what == "all"</code>. If <code>vertical = TRUE</code> then the plots
are arranged vertically. Otherwise, 4 plots are 2 rows of 2 plots and 3
plots are arranged horizontally.</p></dd>


<dt id="arg-main">main<a class="anchor" aria-label="anchor" href="#arg-main"></a></dt>
<dd><p>A character vector. Titles for the histograms.</p></dd>


<dt id="arg-penultimate">penultimate<a class="anchor" aria-label="anchor" href="#arg-penultimate"></a></dt>
<dd><p>A logical scalar. If  <code>distn = "marginal"</code> should
lines be added to plots to indicate the GEV parameter values, or the
implied return levels, from a penultimate approximation based on the
simulation distribution and the block length. See <code><a href="https://lbelzile.github.io/mev/reference/smith.penult.html" class="external-link">mev::smith.penult</a></code>.</p></dd>


<dt id="arg-line-col">line_col<a class="anchor" aria-label="anchor" href="#arg-line-col"></a></dt>
<dd><p>A vector giving the colours of lines added to plots when
<code>distn = "marginal"</code>. <code>line_col[1]</code>: sample median of estimates;
<code>line_col[2]:</code> sample mean of estimates; <code>line_col[3]</code>: true return level
(if <code>what = "return"</code>); <code>line_col[4]</code>: value from an penultimate
approximation (if <code>penultimate = TRUE</code>).</p></dd>


<dt id="arg-line-lty">line_lty<a class="anchor" aria-label="anchor" href="#arg-line-lty"></a></dt>
<dd><p>A numeric vector giving the line types of these vertical
lines.</p></dd>


<dt id="arg-legend">legend<a class="anchor" aria-label="anchor" href="#arg-legend"></a></dt>
<dd><p>A numeric vector of length 4. In which of the 4 plots should a
legend relating to the vertical lines be placed. The default is in the
final plot, the <code>"discard"</code> plot.</p></dd>


<dt id="arg-mar">mar<a class="anchor" aria-label="anchor" href="#arg-mar"></a></dt>
<dd><p>A numeric vector. The number of lines of margin on the four sides
of plots. See <code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></code>.</p></dd>


<dt id="arg-layout">layout<a class="anchor" aria-label="anchor" href="#arg-layout"></a></dt>
<dd><p>A logical scalar. Set <code>layout = TRUE</code> if
<code><a href="https://rdrr.io/r/graphics/layout.html" class="external-link">layout</a></code> is used to create a multi-plot layout
external to the call to <code>plot.evmiss_sim_study</code>.</p></dd>


<dt id="arg-no-ylab">no_ylab<a class="anchor" aria-label="anchor" href="#arg-no-ylab"></a></dt>
<dd><p>A logical scalar. IF <code>no_ylab = TRUE</code> then no axis labels are
placed on the vertical axis.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Further arguments. Only used in the following cases.</p><ul><li><p><code>plot.evmiss_sim_study</code>: to pass graphical parameters to the graphical functions
<code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></code>, <code><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></code>.</p></li>
<li><p><code>print.summary.evmiss_sim_study</code>: if <code>quiet = FALSE</code>, to pass arguments to
<code><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></code>, such as <code>digits</code>.</p></li>
<li><p><code>tab.evmiss_sim_study</code>: to pass arguments to <code>summary.evmiss_sim_study</code>,
such as <code>vsfull</code>.</p></li>
</ul></dd>


<dt id="arg-statistics">statistics<a class="anchor" aria-label="anchor" href="#arg-statistics"></a></dt>
<dd><p>A function used to calculate statistics to summarise the
differences between estimates and the quantities described in <code>vsfull</code>
below. The object returned from this function should be a named vector.
See <strong>Examples</strong>. If <code>statistics</code> is missing then the default is to
calculate the following sample statistics: mean, standard deviation, root
mean squared error, median, inter-quartile range, mean absolute error and
<code>isNA</code>, the number of simulations for which the GEV parameter MLEs are
missing owing to a convergence problem.</p></dd>


<dt id="arg-meanse">meanSE<a class="anchor" aria-label="anchor" href="#arg-meanse"></a></dt>
<dd><p>A logical scalar. If <code>meanSE = TRUE</code> and <code>vsfull = FALSE</code> then
the sample mean of the estimated standard errors over all simulated
datasets is added to the output summary statistics. Otherwise, this is not
added because a comparison of the sample standard deviation of an
estimator to <code>meanSE</code> is only valid for <code>vsfull = FALSE</code>.</p></dd>


<dt id="arg-log">log<a class="anchor" aria-label="anchor" href="#arg-log"></a></dt>
<dd><p>A logical scalar. If <code>log = TRUE</code> then make comparisons for the
GEV scale parameter \(\sigma\) based on estimate of \(\log \sigma.\)
Otherwise, based them on estimates of \(\sigma\).</p></dd>


<dt id="arg-log-return">log_return<a class="anchor" aria-label="anchor" href="#arg-log-return"></a></dt>
<dd><p>A logical scalar. If <code>log_return = TRUE</code> then make
comparisons for return levels on the log scale. Otherwise, use the
original return level scale.</p></dd>


<dt id="arg-vsfull">vsfull<a class="anchor" aria-label="anchor" href="#arg-vsfull"></a></dt>
<dd><p>A logical scalar. If <code>vsfull = TRUE</code> then comparisons are made
relative to the estimates from the <code>"full"</code> case, that is, fitting to data
with no missing values. If <code>vsfull = FALSE</code> then comparisons are made
relative to the true values (<code>what = "return"</code>) or penultimate
approximations to the GEV parameter values (<code>what = "all"</code>).</p></dd>


<dt id="arg-quiet">quiet<a class="anchor" aria-label="anchor" href="#arg-quiet"></a></dt>
<dd><p>A logical scalar. If <code>quiet = TRUE</code> then do not print the
summary to the console.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><strong>Plot method</strong>. No return value, only the plots are produced.</p>
<p><strong>Summary method</strong>. A list object, with class
<code>c("summary.evmiss_sim_study", "list")</code>, containing the original function
call to <code>summary.evmiss_sim_study</code> and the following components, depending
on <code>what</code> and <code>vsfull</code>.</p>
<p>If <code>what = "all"</code>, matrices <code>full_gev</code>, <code>adjust_gev</code> and <code>naive_gev</code>.
Columns 1 to 3 contain the values of the summary statistics relating to
the estimates of \(\mu\), \(\sigma\), \(\xi\) respectively.</p>
<p>If <code>what = "return"</code>, matrices <code>full_rl</code>, <code>adjust_rl</code>, <code>naive_rl</code>.
The columns contain the values of the summary statistics for return levels
corresponding to the return periods in <code>return_period</code>.</p>
<p>The object is printed by <code>print.summary.evmiss_sim_study</code>. The rows
in the matrices described above are interleaved so that values for the
same summary statistic are printed in adjacent rows. If <code>vsfull = TRUE</code>
then all the values in <code>full_gev</code> and <code>full_rl</code> are zero and therefore are
not included when printing. If the elements of the vector returned from
the function <code>statistics</code> are named, then these names are included in the
row names. Otherwise, the names used are <code>stat1</code>, <code>stat2</code> etc.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><strong>Plot method</strong>. The S3 plot method provides plots to compare these 4
approaches based on the point estimates that they produce for return levels
and GEV parameters. Optionally, if <code>penultimate = TRUE</code>, comparisons can be
made with a penultimate GEV approximation to the true distribution of the
relevant block maxima.</p>
<p><strong>The easiest way to appreciate the various plotting options that are
available is to look at the examples in</strong> <code><a href="sim_study.html">sim_study</a></code>.</p>
<p><strong>Summary method</strong>. A matrix containing the values of the statistics in
<code>statistics</code> used to summarise the performance of estimators of GEV
parameters (if <code>what = "all"</code>) or return levels (if `what = "return"). The
columns relate to the GEV parameters or return levels. Each group of 4 rows
relates to a different combination of summary statistic and estimator
(approach to dealing with missingness), indicated by the row names.</p>
<p><strong>Table method, tab</strong>. Creates a table of results in which there is a row
for each estimator. If <code>vsfull = FALSE</code> is passed to
<code>summary.evmiss_sim_study</code> then the first row relates to the <code>"full"</code>
approach. Otherwise, only <code>"adjust"</code>, <code>"naive"</code> and <code>"discard"</code> are
included.</p><ul><li><p>If <code>return_period</code> is supplied then the statistics concern
estimation of these return periods and the statistics included are
mean, standard deviation, root mean squared error, median, inter-quartile
range and mean absolute error.</p></li>
<li><p>Otherwise, the statistics concern the estimation of the GEV parameters and
the statistics included are mean, standard deviation and root mean squared
error.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a></h2>
    <p>See <code><a href="sim_study.html">sim_study</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="sim_study.html">sim_study</a></code>.</p></div>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Paul J. Northrop, Emma S. Simpson.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

