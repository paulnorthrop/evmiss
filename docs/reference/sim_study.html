<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Simulation study — sim_study • evmiss</title><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Simulation study — sim_study"><meta name="description" content="Performs a simulation study to compare different approaches to fitting a
GEV distribution to block maxima when there are missing values in the
underlying raw data. Plot and summary methods enables comparisons of these
approaches to be made. See sim_study_methods."><meta property="og:description" content="Performs a simulation study to compare different approaches to fitting a
GEV distribution to block maxima when there are missing values in the
underlying raw data. Plot and summary methods enables comparisons of these
approaches to be made. See sim_study_methods."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">evmiss</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="nav-link" href="https://github.com/paulnorthrop/evmiss/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Simulation study</h1>
      <small class="dont-index">Source: <a href="https://github.com/paulnorthrop/evmiss/blob/HEAD/R/sim_study.R"><code>R/sim_study.R</code></a></small>
      <div class="d-none name"><code>sim_study.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Performs a simulation study to compare different approaches to fitting a
GEV distribution to block maxima when there are missing values in the
underlying raw data. Plot and summary methods enables comparisons of these
approaches to be made. See <code><a href="sim_study_methods.html">sim_study_methods</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">sim_study</span><span class="op">(</span></span>
<span>  <span class="va">nsim</span>,</span>
<span>  <span class="va">return_periods</span>,</span>
<span>  discard <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  profile <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  mult <span class="op">=</span> <span class="fl">32</span>,</span>
<span>  faster <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  epsilon <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  timeout <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-nsim">nsim<a class="anchor" aria-label="anchor" href="#arg-nsim"></a></dt>
<dd><p>A numeric scalar. The number of simulated datasets.</p></dd>


<dt id="arg-return-periods">return_periods<a class="anchor" aria-label="anchor" href="#arg-return-periods"></a></dt>
<dd><p>A numeric vector of return periods for which estimates
and confidence intervals for the corresponding return levels are
required.</p></dd>


<dt id="arg-discard">discard<a class="anchor" aria-label="anchor" href="#arg-discard"></a></dt>
<dd><p>A numeric scalar. This is used as described in <code><a href="gev_mle.html">gev_mle</a></code>
to discard block maxima based on more than <code>discard</code> percentage of missing
data.</p></dd>


<dt id="arg-level">level<a class="anchor" aria-label="anchor" href="#arg-level"></a></dt>
<dd><p>A numeric scalar in (0,1). The confidence level required for
confidence intervals, to be passed to <code><a href="evmiss_methods.html">confint.evmiss</a></code>.</p></dd>


<dt id="arg-profile">profile<a class="anchor" aria-label="anchor" href="#arg-profile"></a></dt>
<dd><p>A logical scalar. If <code>TRUE</code> then confidence intervals based
on a profile log-likelihood are included in the returned object. If
<code>profile = TRUE</code> then the simulations will take far longer to run.
The arguments <code>mult</code>, <code>faster</code> and <code>epsilon</code> are tuning parameters of the
profiling algorithm.</p></dd>


<dt id="arg-mult">mult<a class="anchor" aria-label="anchor" href="#arg-mult"></a></dt>
<dd><p>A positive numeric scalar. Controls the increment by which the
parameter of interest is increased/decreased when profiling above/below
its MLE. The increment is <code>mult * se / 100</code> where <code>se</code> is the estimated
standard error of the estimator of the parameter. Decreasing <code>mult</code>
profiles at more points but will be slower. The default, <code>mult = 2</code> should
be sufficiently small to produce a smooth looking plot of the profile
log-likelihood using <code><a href="confint_gev_methods.html">plot.confint_gev</a></code>. To estimate the confidence
limits more quickly, the value of <code>mult</code> can be increased and/or the
argument <code>faster</code> set to <code>TRUE</code>.</p></dd>


<dt id="arg-faster">faster<a class="anchor" aria-label="anchor" href="#arg-faster"></a></dt>
<dd><p>A logical scalar. If <code>faster = TRUE</code> then the profiling of the
log-likelihood in search of a lower (upper) confidence limit is started at
the corresponding symmetric lower (upper) confidence limit.</p></dd>


<dt id="arg-epsilon">epsilon<a class="anchor" aria-label="anchor" href="#arg-epsilon"></a></dt>
<dd><p>Only relevant if <code>profile = TRUE</code>. A numeric vector of values
that determine the accuracy of the confidence limits. <code>epsilon</code> is
recycled to the length of the parameter vector <code>parm</code>.</p><ul><li><p>If <code>epsilon[i] &gt; 0</code> then this value is passed as the argument <code>epsilon</code>
to the <code><a href="https://paulnorthrop.github.io/itp/reference/itp.html" class="external-link">itp::itp</a></code> function, which estimates the parameter values for
which the profile log-likelihood for parameter <code>i</code> drops to the value
that defines the confidence limits, once profiling has been successful
in finding an interval within which this value lies.</p></li>
<li><p>If <code>epsilon[i] &lt; 0</code> quadratic interpolation is used, which will tend to
be faster.</p></li>
<li><p>If <code>epsilon[i] = 0</code> then linear interpolation is used, which will be
faster still.</p></li>
</ul></dd>


<dt id="arg-quiet">quiet<a class="anchor" aria-label="anchor" href="#arg-quiet"></a></dt>
<dd><p>A logical scalar. If <code>quiet = FALSE</code> then the number of the
current simulated dataset is printed to the console. Otherwise, nothing is
printed.</p></dd>


<dt id="arg-timeout">timeout<a class="anchor" aria-label="anchor" href="#arg-timeout"></a></dt>
<dd><p>Argument <code>timeout</code> passed to <code><a href="https://henrikbengtsson.github.io/R.utils/reference/withTimeout.html" class="external-link">R.utils::withTimeout</a></code>.
Only relevant if <code>profile = TRUE</code> and <code>return_periods</code> is supplied.
If a call to <code><a href="return_level_methods.html">confint.return_level</a></code> takes longer than <code>timeout</code> seconds
then the calculation is terminated and <code>NA</code> values returned for the
confidence limits.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Further arguments to be passed to <code><a href="sim_data.html">sim_data</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list with class <code>c("sim_study", "list")</code>, with the
following components.</p><ul><li><p><code>parameters</code>: a <code>12</code> by <code>nsim</code> matrix. Column <code>i</code> gives results
for simulation number <code>i</code>. The rows contain 3 sets of estimates of
\(\mu\), \(\sigma\) and \(\xi\), as follows.</p><ul><li><p>rows 1-3 (<code>full</code>): using the full data, that is, with no
missing values.</p></li>
<li><p>rows 4-6 (<code>adjust</code>): with adjustment for the number of non-missing
values.</p></li>
<li><p>rows 7-9 (<code>naive</code>): no adjustment for the number of non-missing
values.</p></li>
<li><p>rows 10-12 (<code>discard</code>): some block maxima may be discarded.</p></li>
</ul></li>
<li><p><code>ses</code>, <code>lower_sym</code>, <code>upper_sym</code>, <code>lower_prof</code>, <code>upper_prof</code>: objects
with the same structure as <code>parameters</code>, containing the corresponding
estimates standard errors and lower and upper limits of 100<code>level</code>%
confidence intervals. <code>lower_prof</code> and <code>upper_prof</code> are included only
if <code>profile = TRUE</code>.</p></li>
<li><p><code>rl_ses</code>, <code>rl_lower_sym</code>, <code>rl_upper_sym</code>, <code>rl_lower_prof</code>,
<code>rl_upper_prof</code>: analogous to the objects immediately above but
relating to the return levels of interest. <code>rl_lower_prof</code> and
<code>rl_upper_prof</code> are included only if <code>profile = TRUE</code>.</p></li>
<li><p><code>nsim</code>: the input value of <code>nsim</code>.</p></li>
<li><p><code>distn</code>: the name of the distribution from which data are simulated,
that is, the argument <code>distn</code> passed to <code><a href="sim_data.html">sim_data</a></code>.</p></li>
<li><p><code>distn_args</code>: user-supplied arguments for <code>distn</code>.</p></li>
<li><p><code>block_length</code>: the block length used to create simulated block maxima.</p></li>
<li><p><code>return_periods</code>: the input argument <code>return_periods</code>.</p></li>
<li><p><code>true_return_levels</code>: a vector containing the true level for each
component of <code>return_periods</code>.</p></li>
</ul><p>The row and column names of the matrices <code>parameters</code> and <code>return_levels</code>
help to describe what is contained in the matrix.</p>
<p>The simulation settings, generated by a call to <code><a href="sim_data.html">sim_data</a></code> with
<code>blocks = 0</code> are provided, as an attribute named <code>"sim_data_args"</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The simulation study is based on raw data simulated from a
user-supplied probability distribution. Missing values are created in
these full data to produce a reduced raw dataset. Samples of block maxima
are created from each of these two datasets. See <code><a href="sim_data.html">sim_data</a></code>.
Three approaches are taken to estimate the 3 parameters of GEV
distribution used to model these block maxima. In each case, parameters
are estimated using maximum likelihood estimation, as described below.
See also <code><a href="gev_mle.html">gev_mle</a></code>.</p><ul><li><p><strong>Full</strong>. Using the full data.</p></li>
<li><p><strong>Adjust</strong>. Using the reduced dataset, with an adjustment for the
numbers of non-missing values underlying each block maximum.</p></li>
<li><p><strong>Naive</strong>. Using the reduced dataset, with no adjustment made for the
presence of missing raw values.</p></li>
<li><p><strong>Discard</strong>. Any block maximum for which greater than <code>discard</code> percent
of the underlying raw values were missing is discarded and no further
adjustment is made.</p></li>
</ul><p>The arguments <code>mult = 32, faster = TRUE</code> and <code>epsilon = -1</code> passed to
<code><a href="evmiss_methods.html">confint.evmiss</a></code> are set with the aim of calculating quickly confidence
intervals based on a profile log-likelihood (if <code>profile = TRUE</code>). However,
for a large simulation study setting <code>faster = FALSE</code> may be more reliable
because it may prevent convergence issues for some simulated datasets.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="sim_study_methods.html">sim_study_methods</a></code>.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># In practice, increasing nsim to 1000, say, is suggested</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">12345</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### Exponential data</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">sim_study</span><span class="op">(</span>nsim <span class="op">=</span> <span class="fl">50</span>, return_periods <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">1000</span><span class="op">)</span>, discard <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### Plots</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Return levels</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Marginal 100-block return level estimates by approach</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="sim_study-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compare 100-block return level estimates between approaches</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span>, distn <span class="op">=</span> <span class="st">"joint"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="sim_study-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## GEV parameter estimates</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># (a) Each parameter marginally, by approach</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span>, what <span class="op">=</span> <span class="st">"mu"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="sim_study-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span>, what <span class="op">=</span> <span class="st">"sigma"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="sim_study-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span>, what <span class="op">=</span> <span class="st">"xi"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="sim_study-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># (b) Each parameter, comparing approaches</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span>, what <span class="op">=</span> <span class="st">"mu"</span>, distn <span class="op">=</span> <span class="st">"joint"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="sim_study-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span>, what <span class="op">=</span> <span class="st">"sigma"</span>, distn <span class="op">=</span> <span class="st">"joint"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="sim_study-7.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span>, what <span class="op">=</span> <span class="st">"xi"</span>, distn <span class="op">=</span> <span class="st">"joint"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="sim_study-8.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># All parameters marginally, for each approach</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span>, what <span class="op">=</span> <span class="st">"all"</span>, approach <span class="op">=</span> <span class="st">"full"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="sim_study-9.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span>, what <span class="op">=</span> <span class="st">"all"</span>, approach <span class="op">=</span> <span class="st">"naive"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="sim_study-10.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span>, what <span class="op">=</span> <span class="st">"all"</span>, approach <span class="op">=</span> <span class="st">"adjust"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="sim_study-11.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span>, what <span class="op">=</span> <span class="st">"all"</span>, approach <span class="op">=</span> <span class="st">"discard"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="sim_study-12.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># All parameters, comparing pairs of different approaches</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span>, what <span class="op">=</span> <span class="st">"all"</span>, distn <span class="op">=</span> <span class="st">"joint"</span>, approach <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"full"</span>, <span class="st">"adjust"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>     vertical <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="sim_study-13.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span>, what <span class="op">=</span> <span class="st">"all"</span>, distn <span class="op">=</span> <span class="st">"joint"</span>, approach <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"adjust"</span>, <span class="st">"naive"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>     vertical <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="sim_study-14.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span>, what <span class="op">=</span> <span class="st">"all"</span>, distn <span class="op">=</span> <span class="st">"joint"</span>, approach <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"adjust"</span>, <span class="st">"discard"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>     vertical <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="sim_study-15.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### Summaries</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## GEV parameter estimates</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Comparison to what would be obtained from the full dataset</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> summary.evmiss_sim_study(object = res)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                              mu        sigma           xi</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bias,adjust         -0.02971768  0.005540924  0.011477016</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bias,naive          -0.33348632  0.028073818 -0.004436578</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bias,discard        -0.11284213 -0.016571757 -0.032669671</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sd,adjust            0.09408087  0.078692990  0.083157879</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sd,naive             0.09594831  0.088741469  0.083109443</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sd,discard           0.20835560  0.171469168  0.156154284</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rmse,adjust          0.09776158  0.078098891  0.083118289</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rmse,naive           0.34674930  0.092226280  0.082393684</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rmse,discard         0.23511096  0.170552822  0.157999318</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> median_bias,adjust  -0.02768807  0.010619613  0.009718407</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> median_bias,naive   -0.32316146  0.045845386 -0.006228680</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> median_bias,discard -0.13840627 -0.034639349 -0.006093888</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iqr,adjust           0.13134064  0.064760903  0.093964235</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iqr,naive            0.09232500  0.134221664  0.081747247</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iqr,discard          0.26139553  0.212108985  0.184119907</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mae,adjust           0.07694070  0.058404502  0.062774961</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mae,naive            0.33348632  0.080407347  0.061358095</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mae,discard          0.20102487  0.136232027  0.115837595</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> isNA,adjust          0.00000000  0.000000000  0.000000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> isNA,naive           0.00000000  0.000000000  0.000000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> isNA,discard         0.00000000  0.000000000  0.000000000</span>
<span class="r-in"><span><span class="co"># Comparison with a penultimate approximation</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res</span>, vsfull <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> summary.evmiss_sim_study(object = res, vsfull = FALSE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                               mu         sigma           xi</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bias,full           -0.003839986 -0.0278597431  0.007790091</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bias,adjust         -0.033557669 -0.0223188192  0.019267107</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bias,naive          -0.337326303  0.0002140746  0.003353513</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bias,discard        -0.116682118 -0.0444314999 -0.024879580</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sd,full              0.171366225  0.1042391559  0.119435053</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sd,adjust            0.181173355  0.1121491021  0.112824824</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sd,naive             0.181756862  0.1248581050  0.114293505</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sd,discard           0.274357871  0.2004838735  0.199664994</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rmse,full            0.169687362  0.1068861585  0.118491024</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rmse,adjust          0.182464862  0.1132431118  0.113340520</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rmse,naive           0.382313851  0.1236034032  0.113194484</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rmse,discard         0.295603642  0.2033815775  0.199217923</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> median_bias,full    -0.029151248 -0.0396456609  0.005521644</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> median_bias,adjust  -0.014729294 -0.0262364061  0.013937393</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> median_bias,naive   -0.322532299  0.0061424001  0.013259862</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> median_bias,discard -0.114827063 -0.0515110337 -0.020418590</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iqr,full             0.254301659  0.1311864912  0.128656835</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iqr,adjust           0.260346039  0.1598136807  0.134456547</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iqr,naive            0.256441257  0.1988598654  0.135090267</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iqr,discard          0.374511341  0.2882915300  0.192845955</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mae,full             0.144175428  0.0865922318  0.092610775</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mae,adjust           0.143941034  0.0918008426  0.090542135</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mae,naive            0.341211780  0.1015589837  0.089672794</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mae,discard          0.233671262  0.1656333584  0.152840558</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> isNA,full            0.000000000  0.0000000000  0.000000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> isNA,adjust          0.000000000  0.0000000000  0.000000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> isNA,naive           0.000000000  0.0000000000  0.000000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> isNA,discard         0.000000000  0.0000000000  0.000000000</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##  Return levels</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Comparison to what would be obtained from the full dataset</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res</span>, what <span class="op">=</span> <span class="st">"return"</span>, return_period <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">1000</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> summary.evmiss_sim_study(object = res, what = "return", return_period = c(100, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     1000))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     100-year return level 1000-year return level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bias,adjust                     0.1338941             0.31124101</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bias,naive                     -0.2857942            -0.37258118</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bias,discard                   -0.2823538            -0.06670583</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sd,adjust                       0.7959645             2.23852312</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sd,naive                        0.7400999             2.02363763</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sd,discard                      1.3593917             3.64364309</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rmse,adjust                     0.7992596             2.23777502</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rmse,naive                      0.7864294             2.03765154</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rmse,discard                    1.3750311             3.60763938</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> median_bias,adjust              0.1858141             0.23345390</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> median_bias,naive              -0.1531247            -0.21822221</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> median_bias,discard            -0.4439982            -0.42997635</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iqr,adjust                      0.9250834             1.84839863</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iqr,naive                       0.9472337             1.91217151</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iqr,discard                     1.8061014             3.33523390</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mae,adjust                      0.6066761             1.54091701</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mae,naive                       0.5704983             1.45369248</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mae,discard                     1.1003469             2.52357506</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> isNA,adjust                     0.0000000             0.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> isNA,naive                      0.0000000             0.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> isNA,discard                    0.0000000             0.00000000</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Comparison with a penultimate approximation</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res</span>, what <span class="op">=</span> <span class="st">"return"</span>, return_period <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">1000</span><span class="op">)</span>, vsfull <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> summary.evmiss_sim_study(object = res, what = "return", return_period = c(100, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     1000), vsfull = FALSE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     100-year return level 1000-year return level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bias,full                      0.14925733              0.7678878</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bias,adjust                    0.28315139              1.0791288</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bias,naive                    -0.13653691              0.3953066</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bias,discard                  -0.13309652              0.7011819</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sd,full                        1.24978525              3.3256363</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sd,adjust                      1.35168836              3.4911734</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sd,naive                       1.12824863              2.9490215</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sd,discard                     1.83593058              5.0337124</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rmse,full                      1.24619487              3.3805786</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rmse,adjust                    1.36773349              3.6206415</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rmse,naive                     1.12522371              2.9460245</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rmse,discard                   1.82234546              5.0322113</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> median_bias,full               0.03182451              0.2036225</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> median_bias,adjust             0.05210663              0.2318654</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> median_bias,naive             -0.35517359             -0.1829064</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> median_bias,discard           -0.41121698             -0.5478823</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iqr,full                       1.45106005              3.2602849</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iqr,adjust                     1.83618493              4.2763547</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iqr,naive                      1.50931836              3.5145841</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iqr,discard                    2.08413213              5.6041252</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mae,full                       0.94110029              2.3387866</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mae,adjust                     1.02879180              2.5172677</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mae,naive                      0.91453792              2.1899685</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mae,discard                    1.47064799              3.4850419</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> isNA,full                      0.00000000              0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> isNA,adjust                    0.00000000              0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> isNA,naive                     0.00000000              0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> isNA,discard                   0.00000000              0.0000000</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example of a user-defined statistics function</span></span></span>
<span class="r-in"><span><span class="va">stat_fn</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res</span>, what <span class="op">=</span> <span class="st">"return"</span>, statistics <span class="op">=</span> <span class="va">stat_fn</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> summary.evmiss_sim_study(object = res, what = "return", statistics = stat_fn)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              100-year return level 1000-year return level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mean,adjust              0.1338941             0.31124101</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mean,naive              -0.2857942            -0.37258118</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mean,discard            -0.2823538            -0.06670583</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sd,adjust                0.7959645             2.23852312</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sd,naive                 0.7400999             2.02363763</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sd,discard               1.3593917             3.64364309</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### Normal data</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">sim_study</span><span class="op">(</span>nsim <span class="op">=</span> <span class="fl">50</span>, distn <span class="op">=</span> <span class="st">"norm"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="sim_study-16.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res</span>, what <span class="op">=</span> <span class="st">"return"</span>, return_period <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">1000</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> summary.evmiss_sim_study(object = res, what = "return", return_period = c(100, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     1000))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     100-year return level 1000-year return level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bias,adjust                   0.053600129            0.134791049</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bias,naive                   -0.019047339            0.041619887</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bias,discard                 -0.033148840            0.027804247</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sd,adjust                     0.198918601            0.502021789</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sd,naive                      0.177874838            0.461368402</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sd,discard                    0.243497104            0.557371611</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rmse,adjust                   0.204083835            0.514931050</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rmse,naive                    0.177114285            0.458623813</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rmse,discard                  0.243318450            0.552469842</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> median_bias,adjust            0.044679395            0.082608287</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> median_bias,naive            -0.003284024            0.024593172</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> median_bias,discard          -0.012996795            0.000804812</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iqr,adjust                    0.120857345            0.274562594</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iqr,naive                     0.117635172            0.230124355</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iqr,discard                   0.217267031            0.480510699</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mae,adjust                    0.132998679            0.309433674</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mae,naive                     0.110236850            0.265913996</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mae,discard                   0.164905141            0.367073189</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> isNA,adjust                   0.000000000            0.000000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> isNA,naive                    0.000000000            0.000000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> isNA,discard                  0.000000000            0.000000000</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Paul J. Northrop, Emma S. Simpson.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

